// routes/publicDestaques.js
const express = require("express");
const router = express.Router();
const pool = require("../config/pool"); // Conex√£o com o banco de dados

// üîì GET /api/public/destaques ‚Äî Lista de produtos em destaque vis√≠vel ao p√∫blico
router.get("/", async (req, res) => {
  try {
    // Consulta que faz JOIN entre a tabela de destaques e os produtos relacionados
    const [rows] = await pool.query(`
      SELECT 
        d.id,                 -- ID do destaque
        p.id AS product_id,   -- ID do produto relacionado
        p.name,               -- Nome do produto
        p.description,        -- Descri√ß√£o do produto
        p.price,              -- Pre√ßo do produto
        p.image               -- Imagem do produto
      FROM destaques d
      JOIN products p ON d.product_id = p.id
    `);

    res.json(rows); // Retorna a lista formatada de produtos em destaque
  } catch (error) {
    console.error("Erro ao buscar destaques p√∫blicos:", error);
    res.status(500).json({ message: "Erro ao buscar destaques." });
  }
});

module.exports = router;
